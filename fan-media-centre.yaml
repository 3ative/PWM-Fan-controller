type: custom:button-card
entity: fan.media_centre_fan
triggers_update: all
name: |-
  [[[ var name = states[entity.entity_id].attributes.friendly_name,
      temp = "sensor." +entity.entity_id.slice(4, -4) + "_temperature",
      fan = "fan." + entity.entity_id.slice(4,-4) + "_fan"
      return name+" | "+states[temp].state + "c | "+states[fan].attributes.percentage+"%"
  ]]]
state:
  - value: 'on'
    styles:
      icon:
        - animation: |-
            [[[var fan = "fan." + entity.entity_id.slice(4,-4) + "_fan",
               input = states[fan].attributes.percentage, InL = 1, InH = 100, OutL = 5, OutH = 0.3,
               output = (input-InL) * (OutH-OutL)/(InH-InL)+OutL
               return 'rotating '+output+'s linear infinite'
            ]]]
styles:
  card:
    - font-size: 15px
    - animation: |-
        [[[ var alarm = "binary_sensor." +entity.entity_id.slice(4,-4)+ "_alarm"
            return(states[alarm].state==='on')?'flasher 1s linear infinite':'none'
        ]]]  
extra_styles: |
  @keyframes flasher {  
            50% {background: radial-gradient(rgb(0,0,0, 10%), rgb(255, 0, 0, 50%)); 
            box-shadow: 0px 0px 20px rgb(255, 0, 0, 100%);}
tap_action:
  action: more-info
  entity: '[[[return "number."+entity.entity_id.slice(4,-4)+"_set_temp"]]]'
