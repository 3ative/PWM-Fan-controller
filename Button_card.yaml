type: custom:button-card
entity: fan.media_centre_fan
triggers_update: all
name: |-
  [[[ var name = states[entity.entity_id].attributes.friendly_name,
      temp = "sensor." +entity.entity_id.slice(4, -4) + "_temperature",
      fan = "fan." + entity.entity_id.slice(4,-4) + "_fan"
      return name+" | "+states[temp].state + "c | "+states[fan].attributes.percentage+"%"]]]
state:
  - value: 'on'
    styles:
      icon:
        - animation: >-
            [[[var pct =
            Math.log2((110-states[entity.entity_id].attributes.percentage)/10)+0.5
                return 'rotating '+(pct)+'s linear infinite'
            ]]]
styles:
  card:
    - animation: |-
        [[[ var alarm = "binary_sensor." +entity.entity_id.slice(4,-4)+ "_alarm"
            return(states[alarm].state==='on')?'flasher 1s linear infinite':'none']]]  
    - font-size: 15px
extra_styles: |
  @keyframes flasher {  
            50% {background: radial-gradient(rgb(0,0,0, 10%), rgb(255, 0, 0, 50%)); 
            box-shadow: 0px 0px 20px rgb(255, 0, 0, 100%);}
tap_action:
  action: more-info
  entity: number.media_centre_set_temp
view_layout:
  position: sidebar
